<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Jimny Commander v5.0</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Roboto+Condensed:ital,wght@1,700&display=swap');
        body { background: #000; color: #fff; font-family: 'Orbitron', sans-serif; margin: 0; padding: 8px; height: 100dvh; display: flex; flex-direction: column; overflow: hidden; }
        .fonte-ft { font-family: 'Roboto Condensed', sans-serif; font-style: italic; text-transform: uppercase; }
        .barra-bg { height: 35px; background: #111; clip-path: polygon(0 0, 100% 0, 98% 100%, 0 100%); position: relative; border-bottom: 2px solid #333; }
        .barra-fill { height: 100%; width: 0%; background: linear-gradient(90deg, #fc0 0%, #f60 70%, #c00 95%); transition: width 0.1s; }
        .shift { animation: flash 0.1s infinite; background: #fff !important; }
        @keyframes flash { 0%, 100% { opacity: 1; } 50% { opacity: 0; } }
        .glass { background: rgba(255,255,255,0.04); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; }
        @media (orientation: portrait) { .main-grid { grid-template-columns: 1fr !important; } .marcha-txt { font-size: 90px !important; } .header-txt { font-size: 14px !important; } }
    </style>
</head>
<body>
    <div class="flex justify-between items-center mb-1">
        <div class="flex items-center gap-2">
            <div id="led" class="w-3 h-3 rounded-full bg-red-900"></div>
            <span id="status" class="text-[8px] text-gray-500 font-bold uppercase">OBDII: Classic (Incompatível)</span>
        </div>
        <h1 class="fonte-ft header-txt italic text-gray-500">JIMNY <span class="text-red-600 font-black">COMMANDER</span></h1>
    </div>

    <div class="mb-2">
        <div class="flex justify-between items-end mb-1">
            <span id="rpm" class="text-4xl font-black italic leading-none">0</span>
            <div id="tag" class="border border-green-500 text-green-500 px-2 py-0.5 rounded text-[9px] font-black uppercase">2H ASFALTO</div>
        </div>
        <div class="barra-bg rounded overflow-hidden"><div id="barra" class="barra-fill"></div></div>
    </div>

    <div class="grid main-grid grid-cols-12 gap-2 flex-grow overflow-hidden mb-2">
        <div class="col-span-7 glass flex flex-col items-center justify-center relative py-4" onclick="simularToque()">
            <span class="absolute top-2 text-[8px] text-gray-600 font-bold uppercase">Marcha (Toque para mudar)</span>
            <div id="marcha" class="text-[110px] font-black italic text-white leading-none marcha-txt">N</div>
            <div class="flex items-baseline gap-1 mt-1"><span id="vel" class="text-3xl font-bold">0</span><span class="text-[9px] text-gray-500 italic">KM/H</span></div>
        </div>
        <div class="col-span-5 flex flex-col gap-2">
            <div class="glass p-3 border-l-4 border-cyan-500 flex flex-col justify-center flex-grow">
                <span class="text-[8px] text-gray-500 font-bold uppercase">Água</span>
                <span class="text-2xl font-black text-cyan-400"><span id="temp">--</span>°C</span>
            </div>
            <div class="glass p-3 border-l-4 border-yellow-500 flex flex-col justify-center flex-grow">
                <span class="text-[8px] text-gray-500 font-bold uppercase">Bateria</span>
                <span class="text-2xl font-black text-yellow-400">12.8V</span>
            </div>
        </div>
    </div>

    <div class="grid grid-cols-3 gap-2 h-12 mb-1">
        <button id="btnCon" class="bg-zinc-900 border-b-2 border-zinc-950 text-white font-black rounded-lg text-[9px] uppercase active:translate-y-0.5 active:border-0">Conectar</button>
        <button id="btnRed" class="bg-zinc-900 border-b-2 border-red-950 text-red-600 font-black rounded-lg text-[9px] uppercase active:translate-y-0.5 active:border-0">Reduzida</button>
        <button id="btnTes" class="bg-zinc-900 border-b-2 border-zinc-950 text-gray-600 font-black rounded-lg text-[9px] uppercase active:translate-y-0.5 active:border-0">Testar</button>
    </div>

    <script>
        let sim = false, red = false, loop, fakeMarcha = 0;
        const up = (rpm, v, t) => {
            document.getElementById('rpm').innerText = Math.floor(rpm);
            document.getElementById('vel').innerText = Math.floor(v);
            document.getElementById('temp').innerText = t;
            document.getElementById('barra').style.width = Math.min((rpm/7500)*100, 100) + "%";
            document.getElementById('barra').className = rpm > 6000 ? 'barra-fill shift' : 'barra-fill';
            let r = (rpm/v)/(red?2.6:1);
            if(!sim) document.getElementById('marcha').innerText = v<5?"N":r>130?"1":r>85?"2":r>60?"3":r>44?"4":"5";
        };

        function simularToque() {
            if(!sim) return;
            fakeMarcha = (fakeMarcha + 1) % 6;
            const marchas = ["N", "1", "2", "3", "4", "5"];
            document.getElementById('marcha').innerText = marchas[fakeMarcha];
        }

        document.getElementById('btnRed').onclick = () => {
            red = !red;
            document.getElementById('tag').innerText = red ? "4L REDUZIDA" : "2H ASFALTO";
            document.getElementById('tag').className = red ? "border border-red-500 text-red-500 px-2 py-0.5 rounded text-[9px] font-black" : "border border-green-500 text-green-500 px-2 py-0.5 rounded text-[9px] font-black";
        };

        document.getElementById('btnTes').onclick = () => {
            if(sim) { clearInterval(loop); sim = false; document.getElementById('status').innerText = "OBDII: OFFLINE"; }
            else { sim = true; document.getElementById('status').innerText = "MODO DEMO (TOQUE NA MARCHA)"; let t=0; loop=setInterval(()=>{ t+=0.05; up(1000+(Math.abs(Math.sin(t))*5000), 40+(Math.sin(t)*20), 91); }, 50); }
        };

        document.getElementById('btnCon').onclick = async () => {
            try {
                const device = await navigator.bluetooth.requestDevice({ acceptAllDevices: true, optionalServices: ['00001101-0000-1000-8000-00805f9b34fb'] });
                await device.gatt.connect();
                document.getElementById('led').style.backgroundColor = "#22c55e";
                document.getElementById('status').innerText = "CONECTADO!";
            } catch (e) {
                alert("ERRO DE HARDWARE: Seu adaptador azul é Bluetooth 2.0 (Classic). O navegador só aceita Bluetooth 4.0 (BLE). Use o modo 'Testar' para ver o visual!");
            }
        };
    </script>
</body>
</html>

